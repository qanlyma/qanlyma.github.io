---
title: 「论」 Utilizing Parallelism in Smart Contracts on Decentralized Blockchains by Taming Application-Inherent Conflicts
category_bar: true
date: 2023-03-30 15:42:57
tags:
categories: 论文阅读
banner_img:
---

区块链系统随着共识技术的发展，性能已经大大提高，通常达到每秒数千笔交易，事务执行成为一个新的性能瓶颈。我们观察到应用内在的冲突是限制执行期间并行性的主要因素。本文提出使用**分区计数器**和特殊的**可交换指令**来打破应用程序冲突链，以最大化性能。我们还提出了 OCC-DA，这是一个具有确定性中止的乐观并发控制调度器，使得在**公链**中使用 OCC 调度成为可能。

<!-- more -->

## 1 INTRODUCTION

我们的发现：

1. 与串行执行相比，并行可实现的总体加速限制在约 4 倍。虽然有许多块的执行速度随着线程数量的增加而加快，但同时很大一部分块的执行情况要差得多。
2. 大多数块都被单个依赖交易链所阻塞，这些交易需要串行执行，因此影响了总体的执行时间。
3. 对瓶颈交易的人工检查显示，它们中的大多数在单个计数器或数组上发生冲突。从应用程序的角度来看，大多数瓶颈交易可以分为三类：代币分发、收藏品和去中心化金融。

研究结果表明，我们工作的重点应该是消除智能合约中这些常见的争用源，而不是优化调度器的实现。本文提出了三种独立的技术来消除上述瓶颈：

1. 最简单方法是使用多个发送方地址。通过手动将从单个发送方的一组交易划分为多个不相交的交易集。

2. 第二种方法是使用分区计数器（partitioned counters），类似于 Sloppy Counters。在这种方法中，我们维护几个子计数器，它们的总和构成原始计数器的值。写入基于某些属性（例如发送方地址）被路由到不同的子计数器并在其上操作。分区计数器可以减少任何两个写入交易冲突的概率。

3. 第三种方法是绕过由虚拟机级别的交换更新引起的可避免冲突。两个增加计数器但不使用其原始值的交易在语义上是可交换的。然而，在当前的以太坊虚拟机语义下，这些增量被转换为读取（SLOAD）和写入（SSTORE）指令，这将导致读写冲突。我们提出了一个名为 CADD（commutative add）的新指令。在给定状态条目上没有其他读写操作，而只有 CADD 操作的两个交易被视为不冲突。增量在交易提交期间逐个应用。

此外，为了解决并行执行导致节点状态不一致问题，我们引入了一种具有确定性事务中止的乐观调度器。这种方法允许我们引入并行性的激励措施，以换取平均可接受的性能影响。

## 2 BACKGROUND AND MOTIVATION

为了解决 Bitcoin 和 Ethereum 的性能瓶颈，大家都做了很多努力。

在并行执行研究上，通过调查以太坊的历史工作负载，我们发现必须按顺序执行的一系列交易的许多关键路径都是由共享全局计数器的使用引起的。我们认为，进一步显著提高实际工作负载固有并行性的重要方法是引入更好的编程范式，使开发人员能够更容易地表达并行性，同时保持原始语义。同时需要对激励机制进行一些新的设计，以使该范式适用于现实世界的应用。

## 3 EMPIRICAL STUDY

